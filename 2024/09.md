# 2024/09 学習記録

**基本スケジュール**
*  オリジナルアプリ開発のベース部分の開発を進める
*  「基本情報技術者」「プリンシプルオブプログラミング」書籍を読む
*   「JavaScript データ・アルゴリズム課題」を復習として最低3問解く

**今月目標**

* オリジナルアプリ開発のベース部分をできるだけ進める
* 過去の課題の復習を毎日取り組む
* 新しい仕事に慣れる

***

## 2024/09/3
- React関連の動画を見る
     -  リハビリで、横たわりながら
- 過去のメモノートを読み返す
     -  横たわりながら

### メモ
-  入社初っ端から風邪で休む大失態を犯す
-  熱が上がったり下がったりで油断できない
-  明日は無事に入社できますように

***

## 2024/09/5
- オリジナルアプリ制作
     -  画像の投稿の検証
     -  Amazon S3 RestAPI：　フロントから直接アップする方法を検証
     -  PutObject APIを使用することにする
     -  署名バージョン4（Sigv4）の署名が必要
     -  必要な情報を調べるためにS3のIAM ユーザーとしてログインしようとしてアクセス拒否される問題
         - ルートユーザーからユーザーに権限を付与してみる
         - 相変わらず
-  「JavaScript データ・アルゴリズム課題」の復習
     -  003_practice/001_easy.spec.js　途中まで
### メモ
-  まだ熱が出たり下がったりを繰り返していて・・マイコプラズマ疑惑
-  でもなんとか入社二日目
-  環境構築を進め中
-  時間があるうちにドキュメントを隅々まで読もう
-  自己学習と業務の両立をできるようにしたい

***

## 2024/09/6
- オリジナルアプリ制作
     -  画像の投稿の検証
     -  Amazon S3 RestAPI：　フロントから直接アップする方法を検証
     -  PutObject APIを使用することにする
     -  署名バージョン4（Sigv4）の署名が必要
     -  個人の開発なのでルートユーザーを使用することに
         - 無事にAWSAccessKeyId・AWSSecretAccessKeyを入手
         - リージョンがGlobalになっていたので
         - AWS CLIをインストールして変更
         - CORS設定が必要そう
-  CORS（クロスオリジンリソース共有）
     -  追加のHTTPヘッダーを使用して、オリジンで動作しているアプリケーションに
     -  異なるオリジンにある選択されたリソースへのアクセス権を与えるようにブラウザに指示するための仕組み
         - セキュリティ上、APIは同じオリジンに対してのみリソースのリクエストを行える
         - それ以外のオリジンからのリクエストは正しいCORSヘッダーを含んでいる必要がある
     -  オリジン
         - webコンテンツにアクセスするためのURLのスキーム・ホスト・ポート番号
-  「JavaScript データ・アルゴリズム課題」の復習
     -  003_practice/001_easy.spec.js　途中まで
### メモ
-  サービスのUIを理解していないと
-  対応した修正の挙動の不具合を見つけられない
-  やっと回復の兆しが見えてきた

***

## 2024/09/7
- オリジナルアプリ制作
     -  画像の投稿の検証
     -  Amazon S3 RestAPI：　フロントから直接アップする方法を検証
     -  PutObject APIを使用することにする
     -  画像のアップロード手順を見直し
         - chatgptを参考に・・・
         - 1.サーバー側で署名付きURLを生成（署名付きURLを生成するエンドポイントを作成）
         - 2.フロントエンドで画像をアップロード
         - 3.CORS設定（ブラウザからS3に直接アップロードするためにはS3バケットでCORS設定をする必要がある）
### メモ
-  今日は土曜授業で授業参観でした
-  最近咳で眠れてなかったけど夕方に寝落ちしてスッキリ

***

## 2024/09/8
- オリジナルアプリ制作
     -  画像の投稿の検証
     -  localでS3へのアップロードができた！
     -  AWS SDKについてもう少し調べてみよう
     -  FBで問題なければ、次はCDNを挟む実装・・・
     -  getSignedURL
         - AWS SDKを使用してバケットのオブジェクトに対して署名付きURLを生成するメソッド
         - 指定された期限内に認証なしでオブジェクトへのアクセスを許可
### メモ
-  今日は地元のお祭りに連れて行き、帰りに焼肉
-  体調も復活したから明日からまた頑張ろう

***

## 2024/09/9
- オリジナルアプリ制作
     -  画像の投稿の検証
- AWS SDK for JavaScript
     -  javascriptを使用して、Node.jsまたはブラウザ用のライブラリでアプリケーションを構築
     -  [S3のクライアント操作](https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/client/s3/)
     -  FB
         - アップロードのパスにバリデーションをかける
         - 署名付きURLを取得する必要のある情報をDBに保存する
         - プルリクエストは必要な差分だけにする
- その他メモ
     -  Content-type
         - リソースのメディア種別を示す
         - Content-typeヘッダーはクライアントに返された実際の種類を伝える
     -  MIME タイプ（メディアタイプ・コンテンツタイプと呼ばれることもある）
         - ファイルの種類を示し、ファイルと共に送信される文字列
         - 例）音声ファイルは「audio/ogg」画像ファイルは「image/png」とラベル付してコンテンツ形式を記述
### メモ
-  頭を使う業務が発生し出した
-  正解が一つではないのと、ルールに沿ったロジックを考えるのがむずかしい

***

## 2024/09/10
- オリジナルアプリ制作
     -  画像の投稿の検証
     -  現状だと画像ファイルのパスがクライアント側で決められてしまっているので、制限をかける
         - ディレクトリ・タイムスタンプをあらかじめ指定する処理に変更
         - DBに保存する情報をどのようにDBに保存するべきか
         - 現状のpostDBへの登録はviewがないから
         - この機会に画像以外のフィールドもviewを作るか・・
- プリンシプルオブプログラミングの「ポリシーと実装の分離」を読む
     -  ポリシーと実装を同じモジュールに混ぜない
         - ポリシーの変更に実装が引きづられ、再利用できない
     -  ポリシーモジュール
         - そのソフトウェアの前提に依存する、ビジネスロジックやその他のモジュールに対する引数の選択を行う部分
     -  実装モジュール
         - そのソフトウェアの前提に依存しない、独立したロジック部分
         - 純粋なモジュール
- JESTについて調べる
     -  業務でテストコードを書くことになり調べる
     -  JavaScriptテスティングフレームワーク
     -  テストのためのメソッドがたくさん用意されている
     -  expect
         - テストを作成する時に、値が特定の値に合致することを確認するためにexpectによって様々な事柄を検証する「マッチャ」を利用できる
     -  マッチャ関数の前につける修飾子
         - .not：反対のことをテストできる
         - .resolves:完了したPromiseの値を取り出す
         - .rejects:rejectされたPromiseの理由を取り出す
     -  今回遭遇したマッチャ
         - .toHaveBeenCalledwidth(arg1,arg2,...):モック関数が特定の引数を与えられて呼び出されたことを確認する
     -  今回遭遇したメソッド
     -  .beforeEach(fn,timeout)
         - 対象のファイルのテストを実行する前に関数を実行する
         - 関数がPromiseの場合、JESTはテストを実行する前にPromiseが解決するのを待つ
         - timeoutのオプションで中断前にどのくらい待機するのか指定できる
     -  .describe(name,fn)
         - テストをいくつかの関連するテストにまとめたブロックを作成できる
### メモ
-  テストを書くときは、いろんなパターンを想像して書く必要がある（あたりまえ）
-  業務が複雑になってきて楽しみと緊張が入り混じる

***

## 2024/09/11
- プリンシプルオブプログラミングの「インターフェイスと実装の分離」を読む
     -  モジュールは「インターフェイス」と「実装」の2つの分離した部分から構成される
     -  インターフェイス
         - モジュールが持つ機能を定義
         - モジュールの使用方法を定める
         - クライアントからアクセス可能な関数のシグネチャから構成される
     -  実装
         - モジュールが持つ機能を実現しているコード部分
         - モジュールが内部で使用するロジック・データが含まれる
         - クライアントからアクセスできない
     -  分離することで
         - クライアントが実装の詳細を知る必要がなくなる
     -  実現するために
         - 格言「インターフェイスのためにプログラミングするのであって、実装に対してプログラミングするのではない」
         - モジュール同士の呼び出しは違いにインターフェイスのみが使用されるようにする
- Vue.jsについて調べる
     -  業務で使っていて優先的にキャッチアップする
     -  チュートリアルに挑戦途中
     -  宣言的レンダリング
         - HTMLを拡張したテンプレート構文を使用
     -  リアクティビリティー
         - JavaScriptの状態に基づいて変化を自動的に追跡し、DOMを更新
     -  単一ファイルコンポーネント（SFC）
         - ロジック（JavaScript）・テンプレート（HTML）・スタイル（CSS）を単一のファイルに収めたもの
     -  2つのAPIスタイル　　OptionsAPI・CompositionAPI
         - OptionsAPI： 数々のオプションからなる1つのオブジェクトを用いてコンポーネントのロジックを定義する・オプションによって定義されたプロパティはコンポーネントのインスタンスを指す「this」を使って関数からアクセスできる・OOPに似てる
         - CompositionAPI: インポートしたAPI関数を使ってコンポーネントのロジックを定義・<script setup>と組み合わせて使う
     -  マスタッシュ構文
         - {{ 変数名 }}とすることで定義したdataの変数を高銀ポー年とやテンプレートに埋め込むことができる
     -  v-bind ディレクティブ
         - 動的な値を属性にバインドする時に使用（マスタッシュ構文はテキスト補間のみ）
         - v-bind:id（引数）="text" → :id="text　に省略できる
     -  v-on ディレクティブ
         - DOMイベントを購読することができる
         - v-on: @に省略できる
         - thisを使ってコンポーネントインスタンスにアクセスできる
     -  v-bind・v-on を両方使ってinput要素に双方向バインディングできる
         - フォームとかで使用
         - <input :value="text" @input="onInput"> 簡略化するシンタックスシュガー　→ <input v-model="text">
     -  条件付きレンダリング
         - v-if
         - v-else
         - v-else-if
     -  リストレンダリング
         - v-for
         - 配列を基にした要素のリストをレンダリングできる
### メモ
-  とりあえず早くVueを理解することが優先・・・

***

## 2024/09/12
- オリジナルアプリ制作
     -  画像の投稿の検証
     -  不明点をまとめる
- Vue.jsについて調べる（続き）
     -  チュートリアル完了
     -  ref
         - テンプレート参照・コンポーネントや要素に直接アクセスする
         - リアクティブなデータを作成できる
         - this.$refs オブジェクトの下に登録される
         - 例） <p ref="p">hello</p>　＝　this.$refs.p
     -  vueのライフサイクルフック（インスタンスのライフサイクルの様々な段階で呼び出せるフック）
         - mounted：　コンポーネントがマウントされた後
         - updated: コンポーネントがリアクティブな状態変更によってDOMツリーを更新した後
         - unmounted: コンポーネントがアンマウントされた時
         - その他いろいろ
     -  コンポーネント
         - 子コンポーネントを使用するには
         - import
         - export default 内に指定
         - <ChildComp />
     -  Props
         - 子コンポーネントは親コンポーネントから入力をpropsとして受け取る
         - 子コンポーネントは受け入れるpropsを宣言→「this」に出力され、子コンポーネントで使用できる
         - 親コンポーネントは属性と同じようにpropsを子に渡せる
         - 動的な値を渡す時は「v-bind」も使える
     -  イベントの発行：　propsだけでなく、子コンポーネントは親にイベントを発行できる
     -  スロット：　親コンポーネントから子コンポーネントにスロットでテンプレートフラグメントを渡す
         - 親がスロットを渡さなかった場合に子コンポーネントにはフォールバックコンテントを指定できる
- Vuexについても調べる
     -  vueでの状態管理を一元化するためのライブラリ
     -  state
         - アプリケーションの状態を管理するために使う
     -  mutations
         - 状態を変更できる唯一の方法のメソッド
         - 「state」・「payload」の2つの引数を受け取る　（payload：状態を変更するための追加データ）
     -  actions
         - 状態を変更するためにmutationsを呼び出す、非同期処理を含むメソッド
         - 「context」・「payload」の2つの引数を受け取る （payloadはあれば）
     -  context
         - アクションの引数として渡されるオブジェクト
         - 「state」・「commit」・「dispach」などストアにアクセスするためのメソッドやプロパティ
### メモ
-  Vueの基礎的なところをざっと確認
-  Vuexも登場

***

## 2024/09/13
- オリジナルアプリ制作
     -  画像の投稿の検証 FB
     -  フロントに表示する時にどんなデータに設定するのか
         - パターン1： キー・バケットを設定しておいて、毎回表示のたびに認証付きURLを発行
         - パターン2： 認証付きURLを保存して有効期限も保存（期限が切れたらリフレッシュさせる）
     -  現在のデモだと画像の表示はURLを知っている人は全員見れるようになってしまっている
     -  URLの発行の仕方が間違っている可能性
         - エラー内容： 「signature Does NotMatch」リクエストの署名を検証した時に、計算した署名が送信された署名と一致しなかった
     -  S3バケットのパブリックアクセスを無効にする
     -  画像の取得にも署名付きURLを使ってアクセスを制限する
     -  手順を最初から見直し
### メモ
-  業務中に飛び交っている不明なキーワードを、調べてノートにメモしてみる

***

## 2024/09/14
- オリジナルアプリ制作
     -  画像の投稿の検証
     -  手順見直し
         - 1.署名付きURLを生成して画像をS3にアップ
         - 2.画像のアップ時にS3のキー（filename）をDBに保存
         - 3.フロントに表示する時は保存されたキーを使って、S3からダウンロード用の署名付きURLを生成
- RESTfulなURL設計とは
     -  名詞を使う
         - URLはリソースの名前（名詞）を使う
         - 操作（動詞）はHTTPメソッドで表現する
     -  階層構造を利用
         - リソースの階層関係をURLに反映
     -  ステートレス
         - HTTPリクエストはステートレスであるべき
         - 各リクエストは必要な情報を含めるべき
- プリンシプルオブプログラミングの「凝集度」を読む
     -  モジュールに含まれている機能の純粋さを表す尺度
         - 高いと： メンテナンス性が高くなる
         - 低いと： 理解しづらく、保守しづらく、再利用しづらいコードに
     -  コードの独立性を高めるためにモジュール「内」での関連性を最大にする
     -  モジュール「間」の関連性を最小にする
### メモ
-  むずかしい・・

***

## 2024/09/15
- オリジナルアプリ制作
     -  画像の投稿の検証
     -  試しにユーザー登録のフロントを作成してDBに登録しようとしてたらDBがおかしくなって復旧に追われる
         - チュートリアルを見ながら新しくデータベース作成してなんとか復旧した（はず）
         - これでなんとか次の作業進める・・
         - 自分の環境だとコマンドが違っていたりするところがあり、次回のためにNotionに残す
         - うまくいったと思ったらポートを3307にしているのに3306になる・・
### メモ
-  明日の早朝がんばる

***

## 2024/09/16
- オリジナルアプリ制作
     -  画像の投稿の検証
     -  試しにユーザー登録のフロントを作成し、DBに登録しようとしてたらDBがおかしくなって復旧に追われるの続き
         - ポートを3307にしているのに3306になる問題
         - Dockerのimageを最初から作り直し（3306で）なんとか復旧
         - なんで前回3307で作ったのかあやふや
     -  JWTの認証をテスト用にモックユーザーを設定する作業
         - モックユーザーを作成するエンドポイント（/mockurl）を設定
              - モックのユーザー情報を定義
              - jwtのtokenを作成
         - useEffectでReactがマウントされた時に（/mockurl）からモックユーザーのトークンを取得
              - 投稿ボタンの関数に取得したJWTトークンをヘッダーに含めて(/post)エンドポイントにリクエストを送信
              - 画像のアップロードと記事情報のサーバー送信（JWTトークンをヘッダーに含める）も並行する
### メモ
-  金魚の調子が悪い・・
